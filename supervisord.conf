[program:tailscaled]
command=/usr/sbin/tailscaled --state=/var/lib/tailscale/tailscaled.state --tun=userspace-networking --socket=/var/run/tailscaled.sock
priority=10

[program:tailscale-up]
command=/bin/sh -c "sleep 15 && tailscale up --authkey=${TS_AUTHKEY} --hostname=${TS_HOSTNAME:-hf-vps} --socket=/var/run/tailscaled.sock ${TS_EXTRA_ARGS:-'--ssh'} || echo 'Tailscale auth skipped (using cached state)'"
autostart=true
autorestart=false
priority=11

[program:sshd]
command=/usr/sbin/sshd -D -e /var/log/sshd.log
priority=20

[program:php-fpm]
command=/usr/sbin/php8.2-fpm -F
priority=30

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
priority=40

[program:socks5]
command=/usr/local/bin/microsocks -i 0.0.0.0 -p 1080
priority=50

[program:periodic-backup]
command=/bin/sh -c "while true; do /scripts/backup.sh; sleep 14400; done"
priority=60
